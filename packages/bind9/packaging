#!/bin/bash
set -eu
exec 2>&1 | tee ${BOSH_INSTALL_TARGET}/build.log

cpus=$(grep -c ^processor /proc/cpuinfo)
version=9.14.0

echo "Installing bind9 v${version} to ${BOSH_INSTALL_TARGET}"
echo "using $cpus CPUs for parallel builds"
echo

# latest versions available at https://ftp.isc.org/isc/bind/
tar -xzvf bind9/bind-${version}.tar.gz
cd bind-${version}
./configure \
  --without-libjson \
  --without-python \
  --prefix=${BOSH_INSTALL_TARGET}
make -j$cpus
make install

echo
echo "DONE"
exit 0
